# Framework-Level Configuration - Optimized for Offline Local LLM (Qwen/LM Studio)

# --- LLM Infrastructure ---
# NOTE: We now explicitly set the provider to 'openai' to match the endpoint in your .env file.
llm:
  provider: "openai" # FIXED: Routes all traffic via OPENAI_API_BASE to LM Studio
  api_key: "" # Leave empty, key is handled by OPENAI_API_KEY env var
  timeout: 300.0
  max_retries: 3

# --- MCP Servers (Tool Registration) ---
# This registers your locally running SearXNG MCP server.
mcp_servers:
  - name: "searxng"
    url: "http://localhost:8088"
    # Note: The tool name 'search_web' is defined in the agents.yaml
    
# --- Cache System ---
cache:
  enabled: true
  cache_type: "file" 
  ttl_seconds: 7200
  max_size: 500

# --- Execution Framework (Concurrency and Optimization) ---
execution:
  max_concurrent_nodes: 10 
  max_parallel_nodes: 8
  max_execution_steps: 500
  rate_limit_rpm: 30
  
  enable_hitl: false
  hitl_timeout_seconds: 1200.0
  node_execution_timeout_seconds: 2400.0
  
  # State management optimization
  state_batch_size: 50
  state_batch_timeout_ms: 100
  enable_state_compression: true
  
  # WebSocket optimization
  ws_batch_size: 50
  ws_batch_timeout_ms: 100
  enable_ws_compression: true
  enable_diff_updates: true
  
  # Immediate slot filling for better concurrency
  enable_immediate_slot_fill: true
  
  # Enhanced timeout strategy with escalation
  timeout_strategy:
    warning_threshold_seconds: 60.0
    soft_timeout_seconds: 180.0
    hard_timeout_seconds: 300.0
    max_recovery_attempts: 3
    enable_aggressive_recovery: true
  
  # Planning Optimization (Forces Hierarchical Execution)
  force_root_node_planning: true 
  skip_atomization: true 

# --- Logging ---
logging:
  level: "INFO"
  enable_console: true
  enable_file: true
  file_rotation: "10 MB"
  file_retention: 3
  console_style: "clean"
  
  # Suppress noisy modules
  module_levels:
    "sentientresearchagent.server.services.broadcast_service": "WARNING"
    "sentientresearchagent.server.services.project_service": "WARNING"
    "sentientresearchagent.core.project_manager": "WARNING"
    "sentientresearchagent.hierarchical_agent_framework.graph.graph_serializer": "WARNING"
    "sentientresearchagent.hierarchical_agent_framework.orchestration": "INFO"
    "sentientresearchagent.hierarchical_agent_framework.graph.cycle_manager": "INFO"
    "sentientresearchagent.hierarchical_agent_framework.node": "INFO"
    "sentientresearchagent.hierarchical_agent_framework.node_handlers": "INFO"

# --- Experiment Configuration ---
experiment:
  base_dir: "experiments"
  results_dir: "results"
  emergency_backup_dir: "emergency_backups"
  configs_dir: "configs"
  retention_days: 30
  auto_cleanup: true
  timestamp_format: "%Y%m%d_%H%M%S"

# --- Default Settings ---
environment: "research"
default_profile: "general_agent"

